(this["webpackJsonpgpx-juggler"]=this["webpackJsonpgpx-juggler"]||[]).push([[0],{259:function(t,e,n){t.exports={Input:"LoadButton_Input__2BOF0"}},447:function(t,e,n){"use strict";n.r(e);var a=n(491),r=n(0),i=n.n(r),c=n(50),o=n.n(c),u=n(28),s=n(16),l=n(506),d=n(507),p=n(508),m=n(499),x=n(45),f=n(500),j=n(502),b=n(493),v=n(492),h=n(496),O=n(481),g=n(482),w=n(486),k=n(255),y=n(256),S=n(120),F=n(117),E=n(265),M=["heartrate","power","cadence","elevation","coordinate"],C=["#F44336","#9C27B0","#3F51B5","#03A9F4","#009688","#8BC34A","#FFEB3B","#FF9800","#795548","#607D8B","#E91E63","#673AB7","#2196F3","#00BCD4","#4CAF50","#CDDC39","#FFC107","#FF5722","#9E9E9E"],P={0:"Activity",1:"Ride",2:"Alpine Ski",3:"Backcountry Ski",4:"Hike",5:"Ice Skate",6:"Inline Skate",7:"Nordic Ski",8:"Roller Ski",9:"Run",10:"Walk",11:"Workout",12:"Snowboard",13:"Snowshoe",14:"Kitesurf",15:"Windsurf",16:"Swim",17:"Virtual Ride",18:"E-Bike Ride",19:"Velomobile",21:"Canoe",22:"Kayaking",23:"Rowing",24:"Stand Up Paddling",25:"Surfing",26:"Crossfit",27:"Elliptical",28:"Rock Climb",29:"Stair-Stepper",30:"Weight Training",31:"Yoga",51:"Handcycle",52:"Wheelchair",53:"Virtual Run"},B=n(240),A=n.n(B);function D(t){return new Promise((function(e,n){var a=new FileReader;a.onload=function(){return e(a.result)},a.onerror=n,a.readAsText(t)}))}var R=n(2);function G(t){var e=t.streams,n=A()(e.flatMap((function(t){return t.data.map((function(t){return t.timestamp}))}))),a=Math.min.apply(Math,Object(u.a)(n)),r=n.map((function(t){return Object(x.a)({timestamp:(t-a)/60},Object.fromEntries(e.map((function(e,n){var a,r=null===(a=e.data.find((function(e){return e.timestamp===t})))||void 0===a?void 0:a.value;return void 0!==r?["s".concat(n),r]:null})).filter((function(t){return null!==t}))))}));return Object(R.jsx)("div",{style:{width:"100%",height:300},children:Object(R.jsx)(O.a,{children:Object(R.jsxs)(g.a,{data:r,margin:{top:5,right:30,left:20,bottom:5},children:[Object(R.jsx)(w.a,{strokeDasharray:"3 3"}),Object(R.jsx)(k.a,{dataKey:"timestamp",type:"number",domain:["dataMin",function(t){return Math.ceil(t)}],allowDecimals:!1,tickFormatter:function(t){return"".concat(t,"min")}}),Object(R.jsx)(y.a,{domain:["dataMin","dataMax"],type:"number",allowDecimals:!1}),Object(R.jsx)(S.a,{labelFormatter:function(t){return function(t){var e=Math.floor(60*t),n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),r=e-3600*n-60*a;return n>0?"".concat(n,":").concat(a.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"),"h"):a>0?"".concat(a,":").concat(r.toString().padStart(2,"0"),"min"):"".concat(r,"s")}(t)},formatter:function(t){return Math.round(t)}}),Object(R.jsx)(F.a,{}),e.map((function(t,e){return Object(R.jsx)(E.a,{type:"monotone",dataKey:"s".concat(e),isAnimationActive:!1,dot:!1,stroke:C[e%C.length],name:t.name},e)}))]})})})}function X(t){var e=t.gpxData,n=Object(r.useState)(e[0].name),a=Object(s.a)(n,2),i=a[0],c=a[1],o=Object(r.useState)(e[0].type),u=Object(s.a)(o,2),l=u[0],d=u[1];return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(f.a,{sx:{mb:3},children:Object(R.jsxs)(j.a,{children:[Object(R.jsx)(b.a,{value:i,onChange:function(t){return c(t.target.value)},size:"small"}),Object(R.jsx)(v.a,{value:l,onChange:function(t){return d(t.target.value)},size:"small",children:Object.entries(P).map((function(t){var e=Object(s.a)(t,2),n=e[0],a=e[1];return Object(R.jsx)(h.a,{value:n,children:a},n)}))})]})}),M.filter((function(t){return"coordinate"!==t})).map((function(t){var n=e.map((function(e){return Object(x.a)(Object(x.a)({},e[t]),{},{name:e.name})})).filter((function(t){return void 0!==t}));return 0===n.length?null:Object(R.jsx)(f.a,{sx:{mb:3},children:Object(R.jsxs)(j.a,{children:[Object(R.jsx)(m.a,{variant:"h5",gutterBottom:!0,component:"div",children:T[t]}),Object(R.jsx)(G,{streams:n})]})},t)}))]})}var T={cadence:"Cadence",elevation:"elevation",heartrate:"Heart Rate",power:"Power",coordinate:"Map"},I=n(53),W=n.n(I),J=n(115),K=n(505),L=n(259),V=n.n(L),H=n(260),N=n(267),_=n(266),z=n(76),U=n.n(z),q={arrayMode:!0,ignoreAttributes:!1,attributeNamePrefix:"",parseAttributeValue:!0};function Y(t){return Q.apply(this,arguments)}function Q(){return(Q=Object(J.a)(W.a.mark((function t(e){var n,a,r,i;return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D(e);case 2:return n=t.sent,a=Object(H.parse)(n,q),r=a.gpx[0].trk[0],i=r.trkseg[0].trkpt,t.abrupt("return",{name:r.name,type:r.type,coordinate:Z(i,"coordinate",et),cadence:Z(i,"cadence",tt),elevation:Z(i,"elevation",at),heartrate:Z(i,"heartrate",$),power:Z(i,"power",nt)});case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Z(t,e,n){return{type:e,data:U()(0,t.length).map((function(e){return{timestamp:(a=t[e],Object(_.a)(Object(N.a)(a.time))),value:n(t[e])};var a}))}}function $(t){var e,n,a,r,i;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a||null===(r=a["gpxtpx:TrackPointExtension"])||void 0===r||null===(i=r[0])||void 0===i?void 0:i["gpxtpx:hr"])&&void 0!==e?e:null}function tt(t){var e,n,a,r,i;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a||null===(r=a["gpxtpx:TrackPointExtension"])||void 0===r||null===(i=r[0])||void 0===i?void 0:i["gpxtpx:cad"])&&void 0!==e?e:null}function et(t){return[t.lat,t.lon]}function nt(t){var e,n,a;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.power)&&void 0!==e?e:null}function at(t){var e;return null!==(e=t.ele)&&void 0!==e?e:null}function rt(t){var e=t.addGPXData,n=Object(r.useRef)(null),a=function(){var t=Object(J.a)(W.a.mark((function t(n){var a,r;return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.target.files){t.next=2;break}return t.abrupt("return");case 2:a=0;case 3:if(!(a<n.target.files.length)){t.next=17;break}return t.prev=4,t.next=7,it(n.target.files[a]);case 7:r=t.sent,e(r),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.error(t.t0);case 14:a++,t.next=3;break;case 17:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("input",{type:"file",accept:".gpx",ref:n,onChange:a,className:V.a.Input}),Object(R.jsx)(K.a,{variant:"contained",onClick:function(){n.current&&(n.current.value="",n.current.click())},children:"Load GPX"})]})}function it(t){return ct.apply(this,arguments)}function ct(){return(ct=Object(J.a)(W.a.mark((function t(e){return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.name.endsWith(".gpx")){t.next=2;break}throw new Error("Unsupported file type");case 2:return t.next=4,Y(e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ot=n(188),ut=n(187),st=n(261),lt=n.n(st),dt=n(262),pt=n.n(dt),mt=n(263),xt=n.n(mt);function ft(t){var e=t.data;return Object(R.jsx)(K.a,{variant:"contained",onClick:function(){var t=function(t){var e=t.name,n=t.type,a=t.coordinate,r=t.cadence,i=t.elevation,c=t.heartrate,o=t.power,s=Object(ut.sortBy)(Object(ut.uniq)([a].concat(Object(u.a)(r?[r]:[]),Object(u.a)(i?[i]:[]),Object(u.a)(c?[c]:[]),Object(u.a)(o?[o]:[])).flatMap((function(t){return t.data.map((function(t){return t.timestamp}))})))),l=Math.min.apply(Math,Object(u.a)(s)),d={gpx:{"@creator":"GPX Juggler","@xmlns":"http://www.topografix.com/GPX/1/1","@version":"1.1","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xsi:schemaLocation":["http://www.topografix.com/GPX/1/1","http://www.topografix.com/GPX/1/1/gpx.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3","http://www.garmin.com/xmlschemas/GpxExtensionsv3.xsd","http://www.garmin.com/xmlschemas/TrackPointExtension/v1","http://www.garmin.com/xmlschemas/TrackPointExtensionv1.xsd"].join(" "),metadata:{time:{"#text":Object(ot.a)(1e3*l)}},trk:{name:{"#text":e},type:{"#text":n}},trkseg:{trkpt:s.map((function(t){return Object(x.a)(Object(x.a)(Object(x.a)({},a.data.find((function(e){return e.timestamp===t}))?{"@lat":a.data.find((function(e){return e.timestamp===t})).value[0],"@lon":a.data.find((function(e){return e.timestamp===t})).value[1]}:{}),{},{time:{"#text":Object(ot.a)(1e3*t)}},(null===i||void 0===i?void 0:i.data.find((function(e){return e.timestamp===t})))?{ele:{"#text":i.data.find((function(e){return e.timestamp===t})).value}}:{}),{},{extensions:Object(x.a)(Object(x.a)({},(null===o||void 0===o?void 0:o.data.find((function(e){return e.timestamp===t})))?{power:{"#text":o.data.find((function(e){return e.timestamp===t})).value}}:{}),{},{"gpxtpx:TrackPointExtension":Object(x.a)(Object(x.a)({},(null===c||void 0===c?void 0:c.data.find((function(e){return e.timestamp===t})))?{"gpxtpx:hr":{"#text":c.data.find((function(e){return e.timestamp===t})).value}}:{}),(null===r||void 0===r?void 0:r.data.find((function(e){return e.timestamp===t})))?{"gpxtpx:cad":{"#text":r.data.find((function(e){return e.timestamp===t})).value}}:{})})})}))}}};return lt.a.create(d).end({pretty:!0})}(e);pt.a.saveAs(new Blob([t],{type:"text/xml"}),"".concat(xt()(e.name||"export"),".gpx"))},children:"Save"})}function jt(){var t=Object(r.useState)([]),e=Object(s.a)(t,2),n=e[0],a=e[1],i=Object(r.useCallback)((function(t){a((function(e){return[].concat(Object(u.a)(e),[t])}))}),[]);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(l.a,{position:"static",sx:{mb:1},children:Object(R.jsx)(d.a,{children:Object(R.jsx)(p.a,{children:Object(R.jsx)(m.a,{variant:"h6",children:"GPX Juggler"})})})}),Object(R.jsxs)(p.a,{children:[Object(R.jsx)(rt,{addGPXData:i}),Object(R.jsx)(ft,{data:{name:"Test",type:5,coordinate:{type:"coordinate",data:[{timestamp:0,value:[0,0]}]}}}),n.length>0&&Object(R.jsx)(X,{gpxData:n})]})]})}o.a.render(Object(R.jsxs)(i.a.StrictMode,{children:[Object(R.jsx)(a.a,{}),Object(R.jsx)(jt,{})]}),document.getElementById("root"))}},[[447,1,2]]]);
//# sourceMappingURL=main.c0b4034e.chunk.js.map