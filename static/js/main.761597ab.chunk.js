(this["webpackJsonpgpx-juggler"]=this["webpackJsonpgpx-juggler"]||[]).push([[0],{259:function(t,e,n){t.exports={Input:"LoadButton_Input__2BOF0"}},446:function(t,e,n){"use strict";n.r(e);var a=n(492),r=n(0),i=n.n(r),c=n(50),o=n.n(c),u=n(510),l=n(511),s=n(512),d=n(507),p=n(489),m=n(16),f=n(502),j=n(504),x=n(494),b=n(493),v=n(498),h=["heartrate","power","cadence","elevation","coordinate"],g=["#F44336","#9C27B0","#3F51B5","#03A9F4","#009688","#8BC34A","#FFEB3B","#FF9800","#795548","#607D8B","#E91E63","#673AB7","#2196F3","#00BCD4","#4CAF50","#CDDC39","#FFC107","#FF5722","#9E9E9E"],O={0:"Activity",1:"Ride",2:"Alpine Ski",3:"Backcountry Ski",4:"Hike",5:"Ice Skate",6:"Inline Skate",7:"Nordic Ski",8:"Roller Ski",9:"Run",10:"Walk",11:"Workout",12:"Snowboard",13:"Snowshoe",14:"Kitesurf",15:"Windsurf",16:"Swim",17:"Virtual Ride",18:"E-Bike Ride",19:"Velomobile",21:"Canoe",22:"Kayaking",23:"Rowing",24:"Stand Up Paddling",25:"Surfing",26:"Crossfit",27:"Elliptical",28:"Rock Climb",29:"Stair-Stepper",30:"Weight Training",31:"Yoga",51:"Handcycle",52:"Wheelchair",53:"Virtual Run"},w=n(25),y=n(43),k=n(240),F=n.n(k),S=n(266),E=F()((function(t){return{files:[],name:"",type:0,streams:{cadence:{enabledFiles:[],aggregation:"average"},coordinate:{enabledFiles:[],aggregation:"average"},elevation:{enabledFiles:[],aggregation:"average"},heartrate:{enabledFiles:[],aggregation:"average"},power:{enabledFiles:[],aggregation:"average"}},setName:function(e){return t((function(){return{name:e}}))},setType:function(e){return t((function(){return{type:e}}))},addFile:function(e){return t((function(t){var n=Object(S.a)(),a=function(e){return Object(y.a)(Object(y.a)({},t.streams[e]),{},{enabledFiles:[].concat(Object(w.a)(t.streams[e].enabledFiles),[n])})};return{name:0===t.files.length?e.name:t.name,type:0===t.files.length?e.type:t.type,files:[].concat(Object(w.a)(t.files),[Object(y.a)(Object(y.a)({},e),{},{id:n})]),streams:{cadence:a("cadence"),coordinate:a("coordinate"),elevation:a("elevation"),heartrate:a("heartrate"),power:a("power")}}}))}}})),M=n(505),P=n(506),B=n(497),C=n(479),A=n(480),R=n(484),G=n(256),T=n(257),D=n(118),X=n(115),I=n(265),N=n(241),W=n.n(N);function J(t){return new Promise((function(e,n){var a=new FileReader;a.onload=function(){return e(a.result)},a.onerror=n,a.readAsText(t)}))}var K=n(2);function L(t){var e=t.files,n=t.type,a=W()(e.flatMap((function(t){return t[n].data.map((function(t){return t.timestamp}))}))),r=Math.min.apply(Math,Object(w.a)(a)),i=a.map((function(t){return Object(y.a)({timestamp:(t-r)/60},Object.fromEntries(e.map((function(e){var a,r=null===(a=e[n].data.find((function(e){return e.timestamp===t})))||void 0===a?void 0:a.value;return void 0!==r?[e.id,r]:null})).filter((function(t){return null!==t}))))}));return Object(K.jsx)("div",{style:{width:"100%",height:300},children:Object(K.jsx)(C.a,{children:Object(K.jsxs)(A.a,{data:i,margin:{top:5,right:30,left:20,bottom:5},children:[Object(K.jsx)(R.a,{strokeDasharray:"3 3"}),Object(K.jsx)(G.a,{dataKey:"timestamp",type:"number",domain:["dataMin",function(t){return Math.ceil(t)}],allowDecimals:!1,tickFormatter:function(t){return"".concat(t,"min")}}),Object(K.jsx)(T.a,{domain:["dataMin","dataMax"],type:"number",allowDecimals:!1}),Object(K.jsx)(D.a,{labelFormatter:function(t){return function(t){var e=Math.floor(60*t),n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),r=e-3600*n-60*a;return n>0?"".concat(n,":").concat(a.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"),"h"):a>0?"".concat(a,":").concat(r.toString().padStart(2,"0"),"min"):"".concat(r,"s")}(t)},formatter:function(t){return Math.round(t)}}),Object(K.jsx)(X.a,{}),e.map((function(t,e){return Object(K.jsx)(I.a,{type:"monotone",dataKey:t.id,isAnimationActive:!1,dot:!1,stroke:g[e%g.length],name:t.name},t.id)}))]})})})}function V(t){var e=t.type,n=E((function(t){return t.files})).filter((function(t){return t[e]}));return 0===n.length?null:Object(K.jsx)(f.a,{children:Object(K.jsxs)(j.a,{children:[Object(K.jsx)(M.a,{"aria-label":"position",row:!0,children:n.map((function(t){return Object(K.jsx)(P.a,{value:t.id,control:Object(K.jsx)(B.a,{}),label:t.name},t.id)}))}),Object(K.jsx)(d.a,{variant:"h5",gutterBottom:!0,component:"div",children:H[e]}),Object(K.jsx)(L,{files:n,type:e})]})})}var H={cadence:"Cadence",elevation:"elevation",heartrate:"Heart Rate",power:"Power",coordinate:"Map"};function _(){var t=E((function(t){return t.files.length})),e=E((function(t){return[t.name,t.setName]})),n=Object(m.a)(e,2),a=n[0],r=n[1],i=E((function(t){return[t.type,t.setType]})),c=Object(m.a)(i,2),o=c[0],u=c[1];return 0===t?null:Object(K.jsxs)(p.a,{spacing:2,direction:"column",children:[Object(K.jsx)(f.a,{children:Object(K.jsx)(j.a,{children:Object(K.jsxs)(p.a,{spacing:1,direction:"row",children:[Object(K.jsx)(x.a,{placeholder:"Name",value:a,onChange:function(t){return r(t.target.value)},size:"small"}),Object(K.jsx)(b.a,{value:o,onChange:function(t){return u(t.target.value)},size:"small",children:Object.entries(O).map((function(t){var e=Object(m.a)(t,2),n=e[0],a=e[1];return Object(K.jsx)(v.a,{value:n,children:a},n)}))})]})})}),h.filter((function(t){return"coordinate"!==t})).map((function(t){return Object(K.jsx)(V,{type:t},t)}))]})}var z=n(53),U=n.n(z),q=n(113),Y=n(501),Q=n(259),Z=n.n(Q),$=n(260),tt=n(268),et=n(267),nt=n(73),at=n.n(nt),rt={arrayMode:!0,ignoreAttributes:!1,attributeNamePrefix:"",parseAttributeValue:!0};function it(t){return ct.apply(this,arguments)}function ct(){return(ct=Object(q.a)(U.a.mark((function t(e){var n,a,r,i;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J(e);case 2:return n=t.sent,a=Object($.parse)(n,rt),r=a.gpx[0].trk[0],i=r.trkseg[0].trkpt,t.abrupt("return",{name:r.name,type:r.type,coordinate:ot(i,"coordinate",st),cadence:ot(i,"cadence",lt),elevation:ot(i,"elevation",pt),heartrate:ot(i,"heartrate",ut),power:ot(i,"power",dt)});case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ot(t,e,n){return{type:e,data:at()(0,t.length).map((function(e){return{timestamp:(a=t[e],Object(et.a)(Object(tt.a)(a.time))),value:n(t[e])};var a}))}}function ut(t){var e,n,a,r,i;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a||null===(r=a["gpxtpx:TrackPointExtension"])||void 0===r||null===(i=r[0])||void 0===i?void 0:i["gpxtpx:hr"])&&void 0!==e?e:null}function lt(t){var e,n,a,r,i;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a||null===(r=a["gpxtpx:TrackPointExtension"])||void 0===r||null===(i=r[0])||void 0===i?void 0:i["gpxtpx:cad"])&&void 0!==e?e:null}function st(t){return[t.lat,t.lon]}function dt(t){var e,n,a;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.power)&&void 0!==e?e:null}function pt(t){var e;return null!==(e=t.ele)&&void 0!==e?e:null}function mt(t){var e=t.addGPXData,n=Object(r.useRef)(null),a=function(){var t=Object(q.a)(U.a.mark((function t(n){var a,r;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.target.files){t.next=2;break}return t.abrupt("return");case 2:a=0;case 3:if(!(a<n.target.files.length)){t.next=17;break}return t.prev=4,t.next=7,ft(n.target.files[a]);case 7:r=t.sent,e(r),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.error(t.t0);case 14:a++,t.next=3;break;case 17:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("input",{type:"file",accept:".gpx",ref:n,multiple:!0,onChange:a,className:Z.a.Input}),Object(K.jsx)(Y.a,{variant:"contained",onClick:function(){n.current&&(n.current.value="",n.current.click())},children:"Load GPX"})]})}function ft(t){return jt.apply(this,arguments)}function jt(){return(jt=Object(q.a)(U.a.mark((function t(e){return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.name.endsWith(".gpx")){t.next=2;break}throw new Error("Unsupported file type");case 2:return t.next=4,it(e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var xt=n(186),bt=n(185),vt=n(261),ht=n.n(vt),gt=n(262),Ot=n.n(gt),wt=n(263),yt=n.n(wt);function kt(t){var e=t.data;return Object(K.jsx)(Y.a,{variant:"contained",onClick:function(){var t=function(t){var e=t.name,n=t.type,a=t.coordinate,r=t.cadence,i=t.elevation,c=t.heartrate,o=t.power,u=Object(bt.sortBy)(Object(bt.uniq)([a].concat(Object(w.a)(r?[r]:[]),Object(w.a)(i?[i]:[]),Object(w.a)(c?[c]:[]),Object(w.a)(o?[o]:[])).flatMap((function(t){return t.data.map((function(t){return t.timestamp}))})))),l=Math.min.apply(Math,Object(w.a)(u)),s={gpx:{"@creator":"GPX Juggler","@xmlns":"http://www.topografix.com/GPX/1/1","@version":"1.1","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xsi:schemaLocation":["http://www.topografix.com/GPX/1/1","http://www.topografix.com/GPX/1/1/gpx.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3","http://www.garmin.com/xmlschemas/GpxExtensionsv3.xsd","http://www.garmin.com/xmlschemas/TrackPointExtension/v1","http://www.garmin.com/xmlschemas/TrackPointExtensionv1.xsd"].join(" "),metadata:{time:{"#text":Object(xt.a)(1e3*l)}},trk:{name:{"#text":e},type:{"#text":n}},trkseg:{trkpt:u.map((function(t){return Object(y.a)(Object(y.a)(Object(y.a)({},a.data.find((function(e){return e.timestamp===t}))?{"@lat":a.data.find((function(e){return e.timestamp===t})).value[0],"@lon":a.data.find((function(e){return e.timestamp===t})).value[1]}:{}),{},{time:{"#text":Object(xt.a)(1e3*t)}},(null===i||void 0===i?void 0:i.data.find((function(e){return e.timestamp===t})))?{ele:{"#text":i.data.find((function(e){return e.timestamp===t})).value}}:{}),{},{extensions:Object(y.a)(Object(y.a)({},(null===o||void 0===o?void 0:o.data.find((function(e){return e.timestamp===t})))?{power:{"#text":o.data.find((function(e){return e.timestamp===t})).value}}:{}),{},{"gpxtpx:TrackPointExtension":Object(y.a)(Object(y.a)({},(null===c||void 0===c?void 0:c.data.find((function(e){return e.timestamp===t})))?{"gpxtpx:hr":{"#text":c.data.find((function(e){return e.timestamp===t})).value}}:{}),(null===r||void 0===r?void 0:r.data.find((function(e){return e.timestamp===t})))?{"gpxtpx:cad":{"#text":r.data.find((function(e){return e.timestamp===t})).value}}:{})})})}))}}};return ht.a.create(s).end({pretty:!0})}(e);Ot.a.saveAs(new Blob([t],{type:"text/xml"}),"".concat(yt()(e.name||"export"),".gpx"))},children:"Save"})}function Ft(){var t=E((function(t){return t.addFile}));return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(u.a,{position:"static",sx:{mb:1},children:Object(K.jsx)(l.a,{children:Object(K.jsx)(s.a,{children:Object(K.jsx)(d.a,{variant:"h6",children:"GPX Juggler"})})})}),Object(K.jsx)(s.a,{children:Object(K.jsxs)(p.a,{spacing:2,direction:"column",children:[Object(K.jsxs)(p.a,{spacing:2,direction:"row",children:[Object(K.jsx)(mt,{addGPXData:t}),Object(K.jsx)(kt,{data:{name:"Test",type:5,coordinate:{type:"coordinate",data:[{timestamp:0,value:[0,0]}]}}})]}),Object(K.jsx)(_,{})]})})]})}o.a.render(Object(K.jsxs)(i.a.StrictMode,{children:[Object(K.jsx)(a.a,{}),Object(K.jsx)(Ft,{})]}),document.getElementById("root"))}},[[446,1,2]]]);
//# sourceMappingURL=main.761597ab.chunk.js.map