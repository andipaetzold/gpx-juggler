(this["webpackJsonpgpx-juggler"]=this["webpackJsonpgpx-juggler"]||[]).push([[0],{260:function(t,e,n){t.exports={Input:"LoadButton_Input__2BOF0"}},447:function(t,e,n){"use strict";n.r(e);var a=n(493),r=n(0),i=n.n(r),c=n(51),o=n.n(c),u=n(28),s=n(16),l=n(508),d=n(509),p=n(510),m=n(506),x=n(488),j=n(45),f=n(501),b=n(503),v=n(495),h=n(494),O=n(498),g=n(482),w=n(483),k=n(487),y=n(256),S=n(257),F=n(120),E=n(117),M=n(266),C=["heartrate","power","cadence","elevation","coordinate"],P=["#F44336","#9C27B0","#3F51B5","#03A9F4","#009688","#8BC34A","#FFEB3B","#FF9800","#795548","#607D8B","#E91E63","#673AB7","#2196F3","#00BCD4","#4CAF50","#CDDC39","#FFC107","#FF5722","#9E9E9E"],B={0:"Activity",1:"Ride",2:"Alpine Ski",3:"Backcountry Ski",4:"Hike",5:"Ice Skate",6:"Inline Skate",7:"Nordic Ski",8:"Roller Ski",9:"Run",10:"Walk",11:"Workout",12:"Snowboard",13:"Snowshoe",14:"Kitesurf",15:"Windsurf",16:"Swim",17:"Virtual Ride",18:"E-Bike Ride",19:"Velomobile",21:"Canoe",22:"Kayaking",23:"Rowing",24:"Stand Up Paddling",25:"Surfing",26:"Crossfit",27:"Elliptical",28:"Rock Climb",29:"Stair-Stepper",30:"Weight Training",31:"Yoga",51:"Handcycle",52:"Wheelchair",53:"Virtual Run"},A=n(241),D=n.n(A);function R(t){return new Promise((function(e,n){var a=new FileReader;a.onload=function(){return e(a.result)},a.onerror=n,a.readAsText(t)}))}var G=n(2);function X(t){var e=t.streams,n=D()(e.flatMap((function(t){return t.data.map((function(t){return t.timestamp}))}))),a=Math.min.apply(Math,Object(u.a)(n)),r=n.map((function(t){return Object(j.a)({timestamp:(t-a)/60},Object.fromEntries(e.map((function(e,n){var a,r=null===(a=e.data.find((function(e){return e.timestamp===t})))||void 0===a?void 0:a.value;return void 0!==r?["s".concat(n),r]:null})).filter((function(t){return null!==t}))))}));return Object(G.jsx)("div",{style:{width:"100%",height:300},children:Object(G.jsx)(g.a,{children:Object(G.jsxs)(w.a,{data:r,margin:{top:5,right:30,left:20,bottom:5},children:[Object(G.jsx)(k.a,{strokeDasharray:"3 3"}),Object(G.jsx)(y.a,{dataKey:"timestamp",type:"number",domain:["dataMin",function(t){return Math.ceil(t)}],allowDecimals:!1,tickFormatter:function(t){return"".concat(t,"min")}}),Object(G.jsx)(S.a,{domain:["dataMin","dataMax"],type:"number",allowDecimals:!1}),Object(G.jsx)(F.a,{labelFormatter:function(t){return function(t){var e=Math.floor(60*t),n=Math.floor(e/3600),a=Math.floor((e-3600*n)/60),r=e-3600*n-60*a;return n>0?"".concat(n,":").concat(a.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"),"h"):a>0?"".concat(a,":").concat(r.toString().padStart(2,"0"),"min"):"".concat(r,"s")}(t)},formatter:function(t){return Math.round(t)}}),Object(G.jsx)(E.a,{}),e.map((function(t,e){return Object(G.jsx)(M.a,{type:"monotone",dataKey:"s".concat(e),isAnimationActive:!1,dot:!1,stroke:P[e%P.length],name:t.name},e)}))]})})})}function T(t){var e=t.gpxData,n=Object(r.useState)(e[0].name),a=Object(s.a)(n,2),i=a[0],c=a[1],o=Object(r.useState)(e[0].type),u=Object(s.a)(o,2),l=u[0],d=u[1];return Object(G.jsxs)(x.a,{spacing:2,direction:"column",children:[Object(G.jsx)(f.a,{children:Object(G.jsxs)(b.a,{children:[Object(G.jsx)(v.a,{value:i,onChange:function(t){return c(t.target.value)},size:"small"}),Object(G.jsx)(h.a,{value:l,onChange:function(t){return d(t.target.value)},size:"small",children:Object.entries(B).map((function(t){var e=Object(s.a)(t,2),n=e[0],a=e[1];return Object(G.jsx)(O.a,{value:n,children:a},n)}))})]})}),C.filter((function(t){return"coordinate"!==t})).map((function(t){var n=e.map((function(e){return Object(j.a)(Object(j.a)({},e[t]),{},{name:e.name})})).filter((function(t){return void 0!==t}));return 0===n.length?null:Object(G.jsx)(f.a,{sx:{mb:3},children:Object(G.jsxs)(b.a,{children:[Object(G.jsx)(m.a,{variant:"h5",gutterBottom:!0,component:"div",children:I[t]}),Object(G.jsx)(X,{streams:n})]})},t)}))]})}var I={cadence:"Cadence",elevation:"elevation",heartrate:"Heart Rate",power:"Power",coordinate:"Map"},W=n(54),J=n.n(W),K=n(115),L=n(507),V=n(260),H=n.n(V),N=n(261),_=n(268),z=n(267),U=n(76),q=n.n(U),Y={arrayMode:!0,ignoreAttributes:!1,attributeNamePrefix:"",parseAttributeValue:!0};function Q(t){return Z.apply(this,arguments)}function Z(){return(Z=Object(K.a)(J.a.mark((function t(e){var n,a,r,i;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R(e);case 2:return n=t.sent,a=Object(N.parse)(n,Y),r=a.gpx[0].trk[0],i=r.trkseg[0].trkpt,t.abrupt("return",{name:r.name,type:r.type,coordinate:$(i,"coordinate",nt),cadence:$(i,"cadence",et),elevation:$(i,"elevation",rt),heartrate:$(i,"heartrate",tt),power:$(i,"power",at)});case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(t,e,n){return{type:e,data:q()(0,t.length).map((function(e){return{timestamp:(a=t[e],Object(z.a)(Object(_.a)(a.time))),value:n(t[e])};var a}))}}function tt(t){var e,n,a,r,i;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a||null===(r=a["gpxtpx:TrackPointExtension"])||void 0===r||null===(i=r[0])||void 0===i?void 0:i["gpxtpx:hr"])&&void 0!==e?e:null}function et(t){var e,n,a,r,i;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a||null===(r=a["gpxtpx:TrackPointExtension"])||void 0===r||null===(i=r[0])||void 0===i?void 0:i["gpxtpx:cad"])&&void 0!==e?e:null}function nt(t){return[t.lat,t.lon]}function at(t){var e,n,a;return null!==(e=null===(n=t.extensions)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.power)&&void 0!==e?e:null}function rt(t){var e;return null!==(e=t.ele)&&void 0!==e?e:null}function it(t){var e=t.addGPXData,n=Object(r.useRef)(null),a=function(){var t=Object(K.a)(J.a.mark((function t(n){var a,r;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.target.files){t.next=2;break}return t.abrupt("return");case 2:a=0;case 3:if(!(a<n.target.files.length)){t.next=17;break}return t.prev=4,t.next=7,ct(n.target.files[a]);case 7:r=t.sent,e(r),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.error(t.t0);case 14:a++,t.next=3;break;case 17:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)("input",{type:"file",accept:".gpx",ref:n,onChange:a,className:H.a.Input}),Object(G.jsx)(L.a,{variant:"contained",onClick:function(){n.current&&(n.current.value="",n.current.click())},children:"Load GPX"})]})}function ct(t){return ot.apply(this,arguments)}function ot(){return(ot=Object(K.a)(J.a.mark((function t(e){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.name.endsWith(".gpx")){t.next=2;break}throw new Error("Unsupported file type");case 2:return t.next=4,Q(e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ut=n(188),st=n(187),lt=n(262),dt=n.n(lt),pt=n(263),mt=n.n(pt),xt=n(264),jt=n.n(xt);function ft(t){var e=t.data;return Object(G.jsx)(L.a,{variant:"contained",onClick:function(){var t=function(t){var e=t.name,n=t.type,a=t.coordinate,r=t.cadence,i=t.elevation,c=t.heartrate,o=t.power,s=Object(st.sortBy)(Object(st.uniq)([a].concat(Object(u.a)(r?[r]:[]),Object(u.a)(i?[i]:[]),Object(u.a)(c?[c]:[]),Object(u.a)(o?[o]:[])).flatMap((function(t){return t.data.map((function(t){return t.timestamp}))})))),l=Math.min.apply(Math,Object(u.a)(s)),d={gpx:{"@creator":"GPX Juggler","@xmlns":"http://www.topografix.com/GPX/1/1","@version":"1.1","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xsi:schemaLocation":["http://www.topografix.com/GPX/1/1","http://www.topografix.com/GPX/1/1/gpx.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3","http://www.garmin.com/xmlschemas/GpxExtensionsv3.xsd","http://www.garmin.com/xmlschemas/TrackPointExtension/v1","http://www.garmin.com/xmlschemas/TrackPointExtensionv1.xsd"].join(" "),metadata:{time:{"#text":Object(ut.a)(1e3*l)}},trk:{name:{"#text":e},type:{"#text":n}},trkseg:{trkpt:s.map((function(t){return Object(j.a)(Object(j.a)(Object(j.a)({},a.data.find((function(e){return e.timestamp===t}))?{"@lat":a.data.find((function(e){return e.timestamp===t})).value[0],"@lon":a.data.find((function(e){return e.timestamp===t})).value[1]}:{}),{},{time:{"#text":Object(ut.a)(1e3*t)}},(null===i||void 0===i?void 0:i.data.find((function(e){return e.timestamp===t})))?{ele:{"#text":i.data.find((function(e){return e.timestamp===t})).value}}:{}),{},{extensions:Object(j.a)(Object(j.a)({},(null===o||void 0===o?void 0:o.data.find((function(e){return e.timestamp===t})))?{power:{"#text":o.data.find((function(e){return e.timestamp===t})).value}}:{}),{},{"gpxtpx:TrackPointExtension":Object(j.a)(Object(j.a)({},(null===c||void 0===c?void 0:c.data.find((function(e){return e.timestamp===t})))?{"gpxtpx:hr":{"#text":c.data.find((function(e){return e.timestamp===t})).value}}:{}),(null===r||void 0===r?void 0:r.data.find((function(e){return e.timestamp===t})))?{"gpxtpx:cad":{"#text":r.data.find((function(e){return e.timestamp===t})).value}}:{})})})}))}}};return dt.a.create(d).end({pretty:!0})}(e);mt.a.saveAs(new Blob([t],{type:"text/xml"}),"".concat(jt()(e.name||"export"),".gpx"))},children:"Save"})}function bt(){var t=Object(r.useState)([]),e=Object(s.a)(t,2),n=e[0],a=e[1],i=Object(r.useCallback)((function(t){a((function(e){return[].concat(Object(u.a)(e),[t])}))}),[]);return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(l.a,{position:"static",sx:{mb:1},children:Object(G.jsx)(d.a,{children:Object(G.jsx)(p.a,{children:Object(G.jsx)(m.a,{variant:"h6",children:"GPX Juggler"})})})}),Object(G.jsx)(p.a,{children:Object(G.jsxs)(x.a,{spacing:2,direction:"column",children:[Object(G.jsxs)(x.a,{spacing:2,direction:"row",children:[Object(G.jsx)(it,{addGPXData:i}),Object(G.jsx)(ft,{data:{name:"Test",type:5,coordinate:{type:"coordinate",data:[{timestamp:0,value:[0,0]}]}}})]}),n.length>0&&Object(G.jsx)(T,{gpxData:n})]})})]})}o.a.render(Object(G.jsxs)(i.a.StrictMode,{children:[Object(G.jsx)(a.a,{}),Object(G.jsx)(bt,{})]}),document.getElementById("root"))}},[[447,1,2]]]);
//# sourceMappingURL=main.5cf0e1ee.chunk.js.map